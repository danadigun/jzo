$(function(){function t(t){$("button[name=save-group]").html("please wait ....");$.ajax({url:"api/ItemGroups",type:"POST",data:$(t).serialize()}).done(function(t){i();n=t.id}).fail(function(){alert("unable to add group")})}function i(){$(".form-group input").prop("disabled",!0);$("#my-dropzone").show();$(".save-changes").hide();$(".complete").show();$(".item-add").show();$(".drop-message").html('<div class ="alert alert-info"><b>Step 1 Complete. <\/b>Next upload group thumbnail image to finish!<\/div>');$(".complete").prop("disabled",!0)}function r(){$("#my-dropzone").hide();$(".complete").hide();$(".item-add").hide()}function u(){$(".form-group input").val("");$(".form-group input").prop("disabled",!1);$(location).attr("href","/group")}r();var n=0;$("form[name=add-group]").validate({rules:{name:{required:!0},description:{required:!0}},messages:{name:{required:"you have to specify the name of this group"},description:{required:"this group needs a good discription"}},submitHandler:function(n){t(n)}});$(".complete").click(function(){u()});Dropzone.options.myDropzone={url:"api/ItemGroupImage",maxFilesize:1.5,maxfiles:1,acceptedFiles:"image/*",uploadMultiple:!1,init:function(){this.on("sending",function(t,i,r){r.append("group_id",n)});this.on("addedfile",function(){this.files.length>1&&this.removeFile(this.files[0])});this.on("success",function(){$(".drop-message").html('<div class ="alert alert-success"><b>Success! <\/b>You have successfully created a new group. Click <b>exit<\/b> to finish!<\/div><div class="alert alert-info ">You can simply replace image by uploading a new one<\/div>');$(".complete").prop("disabled",!1);$(".close-dismiss").hide()});this.on("error",function(){})}}});