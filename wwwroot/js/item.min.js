$(function(){function t(n){$(".save-item").html("please wait..");var t=$(n).serializeFormJSON(),r={name:t.name,price:t.price,description:t.description,ItemGroupId:t.group_id};i(r)}function i(t){$.ajax({url:"api/items",type:"POST",data:t}).done(function(t){n=t.id;r()}).fail(function(){alert("unable to add new item");console.log(erro)})}function r(){$(".form-group input").prop("disabled",!0);$(".form-group select").prop("disabled",!0);$("#item-dropzone").show();$(".item_save-changes").hide();$(".item_complete").show();$(".item-drop-message").html('<div class ="alert alert-info"><b>Step 1 Complete. <\/b>Next upload item thumbnail image to finish!<\/div>');$(".complete").prop("disabled",!0)}function u(){$("#item-dropzone").hide();$(".item_complete").hide();$(".item-add").hide()}function f(){$(".form-group input").val("");$(".form-group input").prop("disabled",!1);$(".form-group select").prop("disabled",!1);$(location).attr("href","/group")}$("form[name=add-item]").validate({rules:{name:{required:!0},description:{required:!0},price:{required:!0,digits:!0},quantity:{required:!0,digits:!0},group_id:{required:!0}},messages:{name:{required:"Please you have to name your item"},description:{required:"Please describe this item briefly"},price:{required:"You have to enter the price of this item",digits:"Only numbers are allowed here"},quantity:{required:"You have to enter the quantity of this item",digits:"Only numbers are allowed here"},group_id:{required:"please select the group this item belongs to"}},submitHandler:function(n){t(n)}});var n=0;u();$(".item_complete").click(function(){f()});Dropzone.options.itemDropzone={url:"api/ItemImage",maxFilesize:1.5,maxfiles:1,acceptedFiles:"image/*",uploadMultiple:!1,init:function(){this.on("sending",function(t,i,r){r.append("item_id",n)});this.on("addedfile",function(){this.files.length>1&&this.removeFile(this.files[0])});this.on("success",function(){$(".item-drop-message").html('<div class ="alert alert-success"><b>Success! <\/b>You have successfully created a item. Click <b>finish<\/b> to finish!<\/div><div class="alert alert-info ">You can simply replace image by uploading a new one<\/div>');$(".item_complete").prop("disabled",!1);$(".item_close-dismiss").hide()});this.on("error",function(){})}}});