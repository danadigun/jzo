$(function(){function r(n){$(".save-item").html("please wait..");var t=$(n).serializeFormJSON(),i={name:t.name,price:t.price,description:t.description,ItemGroupId:t.group_id,quantity:t.quantity};u(i)}function u(t){$.ajax({url:"api/items",type:"POST",data:t}).done(function(t){n=t.id;f()}).fail(function(){alert("unable to add new item");console.log(erro)})}function f(){$(".form-group input").prop("disabled",!0);$(".form-group select").prop("disabled",!0);$("#item-dropzone").show();$(".item_save-changes").hide();$(".item_complete").show();$(".item-drop-message").html('<div class ="alert alert-info"><b>Step 1 Complete. <\/b>Next upload item thumbnail image to finish!<\/div>');$(".complete").prop("disabled",!0)}function e(){$("#item-dropzone").hide();$(".item_complete").hide();$(".item-add").hide()}function i(){$(".form-group input").val("");$(".form-group input").prop("disabled",!1);$(".form-group select").prop("disabled",!1);$(location).attr("href","/group")}function o(n,t){$.ajax({url:"api/Items/"+n,type:"GET"}).done(function(n){t.find(".modal-title").text("Update "+n.name);t.find(".modal-body input[name=edit_name]").val(n.name);t.find(".modal-body input[name=edit_description]").val(n.description);t.find(".modal-body input[name=edit_price]").val(n.price);t.find(".modal-body input[name=edit_quantity]").val(n.quantity);t.find(".modal-body input[name=edit_group_id]").val(n.itemGroupId);t.find(".modal-body input[name=edit_img_url]").val(n.image_url)}).fail(function(n){alert(n)})}function s(n,t){var i=$(n).serializeFormJSON(),r={Id:t,name:i.edit_name,description:i.edit_description,price:i.edit_price,quantity:i.edit_quantity,ItemGroupId:$(".modal-body input[name=edit_group_id]").val(),image_url:$(".modal-body input[name=edit_img_url]").val()};$.ajax({url:"api/Items/"+t,type:"PUT",data:JSON.stringify(r),contentType:"application/json"}).done(function(){c()})}function h(){$("#edit-item-dropzone").hide();$(".item_update_complete").hide()}function c(){$("form[name=update-item] .form-group input").prop("disabled",!0);$("form[name=update-item] .form-group select").prop("disabled",!0);$("#edit-item-dropzone").show();$("form[name=update-item].item_update_changes").hide();$("form[name=update-item].item_update_complete").show();$("form[name=update-item] .edit-item-drop-message").html('<div class ="alert alert-info"><b>Step 1 Complete. <\/b>Next upload item thumbnail image to finish!<\/div>');$("form[name=update-item] .item_update_complete").prop("disabled",!0)}var n,t;$("form[name=add-item]").validate({rules:{name:{required:!0},description:{required:!0},price:{required:!0,digits:!0},quantity:{required:!0,digits:!0},group_id:{required:!0}},messages:{name:{required:"Please you have to name your item"},description:{required:"Please describe this item briefly"},price:{required:"You have to enter the price of this item",digits:"Only numbers are allowed here"},quantity:{required:"You have to enter the quantity of this item",digits:"Only numbers are allowed here"},group_id:{required:"please select the group this item belongs to"}},submitHandler:function(n){r(n)}});n=0;e();$(".item_complete").click(function(){i()});Dropzone.options.itemDropzone={url:"api/ItemImage",maxFilesize:1.5,maxfiles:1,acceptedFiles:"image/*",uploadMultiple:!1,init:function(){this.on("sending",function(t,i,r){r.append("item_id",n)});this.on("addedfile",function(){this.files.length>1&&this.removeFile(this.files[0])});this.on("success",function(){$(".item-drop-message").html('<div class ="alert alert-success"><b>Success! <\/b>You have successfully created an item. Click <b>finish<\/b> to finish!<\/div><div class="alert alert-info ">You can simply replace image by uploading a new one<\/div>');$(".item_complete").prop("disabled",!1);$(".item_close-dismiss").hide()});this.on("error",function(){})}};$(".remove-item").click(function(n){n.preventDefault();var t=$(this).attr("data-id");swal({title:"Remove an item",text:"Are you sure you want to delete this item from the store?",type:"warning",showCancelButton:!0,closeOnConfirm:!1,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0},function(){$.ajax({url:"../api/items/"+t,type:"DELETE"}).done(function(){swal("success","successfully removed item: "+t,"success");$("#tr_item_"+t).fadeOut()}).fail(function(n){swal("error","unable to delete item:  "+t,"error");console.log(n)})})});t=0;$("#EditModal").on("show.bs.modal",function(n){var u=$(n.relatedTarget),i=u.data("whatever"),r;t=i;h();r=$(this);o(i,r);$("form[name=update-item]").submit(function(n){n.preventDefault()}).validate({rules:{edit_name:{required:!0},edit_description:{required:!0},edit_price:{required:!0,digits:!0},edit_quantity:{required:!0,digits:!0},edit_group_id:{required:!0}},messages:{name:{required:"Please you have to name your item"},description:{required:"Please describe this item briefly"},price:{required:"You have to enter the price of this item",digits:"Only numbers are allowed here"},quantity:{required:"You have to enter the quantity of this item",digits:"Only numbers are allowed here"},group_id:{required:"please select the group this item belongs to"}},submitHandler:function(n){s(n,i)}})});$(".item_update_complete").click(function(){i()});Dropzone.options.editItemDropzone={url:"api/ItemImage",maxFilesize:1.5,maxfiles:1,acceptedFiles:"image/*",uploadMultiple:!1,init:function(){this.on("sending",function(n,i,r){r.append("item_id",t)});this.on("addedfile",function(){this.files.length>1&&this.removeFile(this.files[0])});this.on("success",function(){$(".edit-item-drop-message").html('<div class ="alert alert-success"><b>Success! <\/b>You have successfully created an item. Click <b>finish<\/b> to finish!<\/div><div class="alert alert-info ">You can simply replace image by uploading a new one<\/div>');$(".item_update_complete").prop("disabled",!1);$(".item_update_changes").hide();$(".item_update_complete").fadeIn();$(".item_close-dismiss").hide()});this.on("error",function(){})}}});